# Smart_Parking_System

## 임베디드 시스템 최종보고서
**2조 : 배지호 박상원 김용빈 이재홍**

---
## 목차 ##
1. 프로젝트 소개
2. 시스템 구조
3. 사용 센서 및 액추에이터
4. 기능 구현
5. 주요 함수
6. 사용법
7. 시현 동영상
8. 한계

---
## 1. 프로젝트 소개
### 주제
자동차를 주차만 할 수 있는 주차장이 아닌 여러가지 기능이 추가된 주차장이다.
추가되는 기능들은 다음과 같다.
- 출입차량 파악
- 주차 공간 현황 모니터링 및 LED표시
- 디스플레이와 앱에 실시간 출력
- 출차 주차시간 관리

기존에 있던 주차 관리 시스템과의 차별성을 두기 위해서 어플을 만들어 주차장이 아니더라도 주차장의 현재 상태를 확인할 수 있도록 하였다.

---
## 2. 시스템 구조
![시스템 구조](Images/System%20Structure.png)
시스템 구조는 다음과 같습니다.
- 메인 서버가 존재하고 모든 데이터를 보유 하고 있으며 필요에 따라 데이터를 송 수신함
- 초음파 센서를 통해서 차량 유무를 감지하고 LED 시각화 함. 그 후 데이터를 메인 서버로 전송
- 메인 서버로 부터 데이터를 받아 디스플레이 및 앱에 표시함
- 차량이 감지되면 사진을 촬영하고 번호를 인식하여 메인서버로 해당 데이터를 보냄.
- 서버에 해당 번호에 대한 정보 유무를 통해 입차인지 출차인지 구분함.
- 입차라면 입차 시간을 기록하고, 출차라면 주차시간을 계산해서 요금을 부과하고 차단봉을 여러서 통과시킴.

---
## 3. 사용 센서 및 액추에이터
![센서](Images/Sensor.png)
사용 센서 및 액추에이터는 다음과 같습니다.
- 초음파 센서를 이용해서 감지한 거리가 일정 거리 이하라면 차량이 존재한다고 인식함.
- 초음파 센서를 통해 차량 유무를 확인 한 뒤, LED로 시각화 함.
- 서브 모터를 이용해서 차단봉을 올리고 내리며, 출입 차량을 관리함.
- 7 세그먼트 디스플레이를 통해 1층 여분 자리, 2층 여분 자리, 총합 여분 자리를 보여줌.
- 카메라 모듈로 번호판을 찍어서 번호를 인식함 (추후 언급할 한계점으로 현재는 노트북 웹캠으로 대체)

---
## 4. 기능 구현
저희는 라즈베리 파이를 총 4대 사용하였습니다. 전압문제 및 과부하 방지를 위해서 최대한 라즈베리파이를 여러개 사용하려 노력하였습니다.
- 첫번째 라즈베리파이와 두번째 라즈베리파이는 초음파 센서를 2개씩 연결하여 차량 감지에 사용했습니다.
- 세번째 라즈베리파이는 메인서버역할과 출입차량 감지를 실행하였습니다. 출입차량 감지는 수동으로 진행되며 자동화시키지 못한점이 한계점으로 남아있습니다.
- 또한 세번째 라즈베리파이는 주차시간계산도 진행합니다. 시간측정은 C라이브러리인 <time.h>를 이용합니다.
- 메인서버와의 통신은 모두 와이파이 통신으로 이루어져있습니다. 소켓 통신으로 동작하며 클라이언트마다 그에 맞는 쓰레드 함수를 실행시켜 쓰레드를 적극적으로 사용하였습니다.
- 네번째 라즈베리파이는 7 세그먼트 연 동영상
[https://youtu.be/YR0sNVt3elI](https://youtu.be/YR0sNVt3elI)

## 8. 한계점
- 라즈베리파이의 성능으로 인해 주차장의 크기를 확장시킬 수 없었음.
- 라즈베리파이의 성능으로 인해 좀 더 고성능의 숫자인식 프로그램 적용이 어려워 간단한 숫자 인식으로 변경.
- 개발기간이 촉박하여 출입차량 초음파 감지를 구현하지 못함
- 라즈베리파이의 카메라 모듈의 성능이 매우 좋지 못하여 노트북 웹캠으로 카메라 모듈을 대체함
